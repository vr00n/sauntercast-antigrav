const f=async(o,c)=>{const e=new TextEncoder,s=e.encode(JSON.stringify(o)),d=e.encode(c),y=await crypto.subtle.importKey("raw",d,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),t=crypto.getRandomValues(new Uint8Array(16)),i=await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},y,{name:"AES-GCM",length:256},!1,["encrypt"]),r=crypto.getRandomValues(new Uint8Array(12)),a=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},i,s),n=new Uint8Array(t.length+r.length+a.byteLength);return n.set(t,0),n.set(r,t.length),n.set(new Uint8Array(a),t.length+r.length),btoa(String.fromCharCode(...n))},u=async(o,c)=>{try{const e=Uint8Array.from(atob(o),l=>l.charCodeAt(0)),s=e.slice(0,16),d=e.slice(16,28),y=e.slice(28),i=new TextEncoder().encode(c),r=await crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),a=await crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},r,{name:"AES-GCM",length:256},!1,["decrypt"]),n=await crypto.subtle.decrypt({name:"AES-GCM",iv:d},a,y),p=new TextDecoder().decode(n);return JSON.parse(p)}catch{throw new Error("Decryption failed. Incorrect password or corrupted data.")}};export{u as decryptData,f as encryptData};
